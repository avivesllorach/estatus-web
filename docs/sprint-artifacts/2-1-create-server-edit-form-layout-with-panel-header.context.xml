<story-context id=".bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>2</epicId>
    <storyId>2.1</storyId>
    <title>Create Server Edit Form Layout with Panel Header</title>
    <status>drafted</status>
    <generatedAt>2025-11-19</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/sprint-artifacts/2-1-create-server-edit-form-layout-with-panel-header.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>user</asA>
    <iWant>to see a server edit form when I select a server from the list</iWant>
    <soThat>I can view and modify server configuration</soThat>
    <tasks>
      - Task 1: Create PanelHeader component (AC: 1, 2, 3)
      - Task 2: Integrate PanelHeader into MainPanel when server selected (AC: 4)
      - Task 3: Update ConfigPage to pass selected server data (AC: 1)
      - Task 4: Test visual design and interactions (AC: All)
    </tasks>
  </story>

  <acceptanceCriteria>
    1. PanelHeader component with title "Edit Server: [Server Name]" (20px, semibold) and three action buttons (Delete/Cancel/Save Server) with correct variants
    2. Panel header is sticky (stays visible on scroll)
    3. Panel header has 16px vertical padding, 24px horizontal padding
    4. Below header shows scrollable content area with light gray background (#fafafa)
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/epics.md</path>
        <title>Epic Breakdown - Story 2.1</title>
        <section>Epic 2: Server Management - Story 2.1</section>
        <snippet>Create PanelHeader component with title and action buttons (Delete, Cancel, Save Server). Panel header is sticky with 16px vertical padding and 24px horizontal padding. Below header is scrollable content area with light gray background.</snippet>
      </doc>
      <doc>
        <path>docs/sprint-artifacts/tech-spec-epic-2.md</path>
        <title>Epic Technical Specification: Server Management</title>
        <section>Component References - PanelHeader</section>
        <snippet>PanelHeader: Fixed header with title + action buttons. Title (20px semibold), Action buttons (Delete, Cancel, Save Server), Sticky header with button group, isDirty indicator support</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>Architecture - Component Architecture</title>
        <section>Frontend Component Hierarchy</section>
        <snippet>ConfigPage → ConfigLayout → MainPanel → PanelHeader (NEW in Story 2.1) with Title + Action buttons. MainPanel enhanced with conditional rendering for server selection.</snippet>
      </doc>
      <doc>
        <path>docs/sprint-artifacts/1-7-add-add-server-and-add-group-buttons-to-sidebar.md</path>
        <title>Previous Story - Learnings</title>
        <section>Completion Notes</section>
        <snippet>shadcn/ui Button component usage with variants (primary, secondary, destructive). Button sizing: size="sm" for compact contexts. No-op onClick handlers during foundation stories: onClick={() => {}}. Proper TypeScript interfaces for component props.</snippet>
      </doc>
    </docs>
    <code>
      <artifact>
        <path>src/components/config/MainPanel.tsx</path>
        <kind>component</kind>
        <symbol>MainPanel</symbol>
        <lines>1-27</lines>
        <reason>Existing MainPanel component that needs to be enhanced with PanelHeader integration for server selection. Currently shows EmptyState when nothing selected, needs conditional rendering for server editing.</reason>
      </artifact>
      <artifact>
        <path>src/components/ui/button.tsx</path>
        <kind>component</kind>
        <symbol>Button</symbol>
        <lines>1-58</lines>
        <reason>shadcn/ui Button component with variants (default, destructive, secondary) and sizes (default, sm, lg, icon). Used for Delete, Cancel, and Save Server buttons in PanelHeader.</reason>
      </artifact>
      <artifact>
        <path>src/components/config/Sidebar.tsx</path>
        <kind>component</kind>
        <symbol>Sidebar</symbol>
        <lines>all</lines>
        <reason>Server selection happens in Sidebar, which triggers MainPanel to show PanelHeader with selected server details. Reference for understanding selectedServerId flow.</reason>
      </artifact>
      <artifact>
        <path>src/components/config/EmptyState.tsx</path>
        <kind>component</kind>
        <symbol>EmptyState</symbol>
        <lines>all</lines>
        <reason>Default component shown when no server/group selected. PanelHeader should replace EmptyState when server is selected.</reason>
      </artifact>
    </code>
    <dependencies>
      <node>
        <react>^18.2.0</react>
        <react-dom>^18.2.0</react-dom>
        <react-router-dom>^7.9.6</react-router-dom>
        <lucide-react>^0.554.0</lucide-react>
        <radix-ui-react-slot>^1.2.4</radix-ui-react-slot>
        <class-variance-authority>^0.7.1</class-variance-authority>
        <clsx>^2.1.1</clsx>
        <tailwind-merge>^3.4.0</tailwind-merge>
      </node>
    </dependencies>
  </artifacts>

  <constraints>
    - Use shadcn/ui Button component for all buttons (Delete, Cancel, Save Server)
    - Delete button must use variant="destructive" (red text, red border)
    - Cancel button must use variant="secondary" (white background, gray border)
    - Save Server button must use variant="default" (blue background, white text)
    - All buttons use size="sm" for compact sizing
    - PanelHeader must be sticky (className="sticky top-0 z-10")
    - Title must be 20px (text-xl), semibold (font-semibold), gray-900 color
    - Header padding: 16px vertical (py-4), 24px horizontal (px-6)
    - Content area below header: light gray background (#fafafa, bg-gray-50)
    - Content area must be scrollable (overflow-y-auto)
    - Use flexbox for header layout: title left, buttons right (justify-between)
    - Button group gap: 8px (gap-2)
    - onClick handlers are no-op for Story 2.1: () => {}
    - No form fields yet (added in Stories 2.2-2.5)
    - TypeScript interfaces must define all prop types explicitly
    - Additive changes only - do not break existing MainPanel behavior
    - EmptyState must still show when no server/group selected
    - Build must pass TypeScript compilation with no errors
  </constraints>

  <interfaces>
    <interface>
      <name>PanelHeaderProps</name>
      <kind>TypeScript interface</kind>
      <signature>
        interface PanelHeaderProps {
          title: string               // "Edit Server: ARAGÓ-01"
          onDelete: () => void        // Delete button handler
          onCancel: () => void        // Cancel button handler
          onSave: () => void          // Save button handler
          isDirty?: boolean           // Optional: show unsaved indicator (Epic 2.9)
        }
      </signature>
      <path>src/components/config/PanelHeader.tsx</path>
    </interface>
    <interface>
      <name>MainPanelProps (existing)</name>
      <kind>TypeScript interface</kind>
      <signature>
        interface MainPanelProps {
          selectedServerId: string | null
          selectedGroupId: string | null
          children?: ReactNode
        }
      </signature>
      <path>src/components/config/MainPanel.tsx</path>
    </interface>
    <interface>
      <name>ButtonProps (shadcn/ui)</name>
      <kind>TypeScript interface</kind>
      <signature>
        interface ButtonProps extends React.ButtonHTMLAttributes&lt;HTMLButtonElement&gt;, VariantProps&lt;typeof buttonVariants&gt; {
          asChild?: boolean
        }
        // Variants: default, destructive, outline, secondary, ghost, link
        // Sizes: default, sm, lg, icon
      </signature>
      <path>src/components/ui/button.tsx</path>
    </interface>
  </interfaces>

  <tests>
    <standards>
      Epic 1 uses manual testing (no automated tests required for MVP UI foundation per PRD). Build verification with TypeScript compilation. Visual verification through manual QA. Keyboard accessibility testing.
    </standards>
    <locations>
      - No test files for Epic 1/2 MVP
      - Build verification: npm run build
      - Manual testing: http://localhost:5173/config
    </locations>
    <ideas>
      - AC1: Verify PanelHeader renders with correct title and three buttons
      - AC1: Verify button variants (destructive, secondary, default) match UX spec
      - AC2: Verify header is sticky by scrolling content area
      - AC3: Verify header padding: 16px vertical, 24px horizontal
      - AC4: Verify content area has light gray background and is scrollable
      - Integration: Click server in sidebar, verify PanelHeader appears with server name
      - Integration: Verify EmptyState still shows when no server selected
      - Build: npm run build passes with no TypeScript errors
    </ideas>
  </tests>
</story-context>
