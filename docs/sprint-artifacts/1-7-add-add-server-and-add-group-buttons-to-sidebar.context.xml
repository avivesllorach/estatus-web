<story-context id=".bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>1</epicId>
    <storyId>1.7</storyId>
    <title>Add "Add Server" and "Add Group" Buttons to Sidebar</title>
    <status>drafted</status>
    <generatedAt>2025-11-19</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/sprint-artifacts/1-7-add-add-server-and-add-group-buttons-to-sidebar.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>user</asA>
    <iWant>to see "+ Add Server" and "+ Add Group" buttons in the sidebar</iWant>
    <soThat>I can initiate creation workflows</soThat>
    <tasks>
      - Task 1: Add "+ Add Server" button to Sidebar (AC: 1, 3, 4, 5)
      - Task 2: Add "+ Add Group" button to Sidebar (AC: 2, 3, 4, 5)
      - Task 3: Ensure proper spacing and visual hierarchy (AC: 3)
      - Task 4: Verify keyboard accessibility (AC: 5)
      - Task 5: Test visual design and responsiveness (AC: All)
    </tasks>
  </story>

  <acceptanceCriteria>
    <criterion id="1">
      <given>I am on the `/config` page</given>
      <when>I view the sidebar</when>
      <then>I see "+ Add Server" button at the top of the SERVERS section</then>
    </criterion>
    <criterion id="2">
      <given>Continued from AC1</given>
      <when>I view the sidebar</when>
      <then>I see "+ Add Group" button at the top of the GROUPS section</then>
    </criterion>
    <criterion id="3">
      <given>Buttons are displayed</given>
      <when>I inspect their properties</when>
      <then>Both buttons use shadcn/ui Button component with secondary variant (white background, gray border), small size (compact for sidebar), Plus icon prefix, and full width within sidebar (with padding)</then>
    </criterion>
    <criterion id="4">
      <given>Buttons are displayed</given>
      <when>I click the buttons</when>
      <then>Nothing happens currently (event handlers added in Epic 2 and 3)</then>
    </criterion>
    <criterion id="5">
      <given>Buttons are displayed</given>
      <when>I use keyboard navigation</when>
      <then>Buttons are keyboard accessible with tab order and enter to activate</then>
    </criterion>
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/epics.md</path>
        <title>Epic Breakdown</title>
        <section>Story 1.7: Add "Add Server" and "Add Group" Buttons to Sidebar</section>
        <snippet>Story adds "+ Add Server" and "+ Add Group" buttons in sidebar sections using shadcn/ui Button component. Buttons use secondary variant, small size, Plus icon prefix, and full width. Currently no-op onClick handlers (functionality in Epic 2 and 3).</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>Configuration UI Architecture</title>
        <section>Component Architecture</section>
        <snippet>Frontend component hierarchy: ConfigPage → ConfigLayout → Sidebar (contains ServerListItem[], GroupListItem[], and add buttons). Sidebar is 280px fixed width with white background and gray border-right.</snippet>
      </doc>
      <doc>
        <path>docs/ux-design-specification.md</path>
        <title>UX Design Specification</title>
        <section>4.1 Sidebar Design</section>
        <snippet>Sidebar layout includes "+ Add Server" and "+ Add Group" buttons at top of respective sections. Buttons use secondary variant (white background, gray border), small size for compact sidebar, Plus icon from lucide-react (16px). Section labels "SERVERS" and "GROUPS" are uppercase, 12px, gray.</snippet>
      </doc>
      <doc>
        <path>docs/prd.md</path>
        <title>Product Requirements Document</title>
        <section>User Interface and Navigation, Key Interactions</section>
        <snippet>FR1-FR3 cover navigation to /config. Config page uses split-view layout with left sidebar (280px) for server/group lists and "+ Add" buttons. Clicking "+ Add Server" initiates server creation workflow (Epic 2).</snippet>
      </doc>
    </docs>
    <code>
      <artifact>
        <path>src/components/config/Sidebar.tsx</path>
        <kind>component</kind>
        <symbol>Sidebar</symbol>
        <lines>1-139</lines>
        <reason>Primary file to modify - add "+ Add Server" and "+ Add Group" buttons above server and group list items respectively. Currently contains ServerListItem and GroupListItem with keyboard navigation support.</reason>
      </artifact>
      <artifact>
        <path>src/components/ui/button.tsx</path>
        <kind>component</kind>
        <symbol>Button</symbol>
        <lines>1-58</lines>
        <reason>shadcn/ui Button component to use. Supports variant="secondary" (white background, gray border with hover state), size="sm" (compact 32px height, 12px horizontal padding), and className for full width.</reason>
      </artifact>
      <artifact>
        <path>src/components/config/ServerListItem.tsx</path>
        <kind>component</kind>
        <symbol>ServerListItem</symbol>
        <lines>existing</lines>
        <reason>Referenced in Sidebar.tsx - no changes needed, but buttons will be positioned above this list</reason>
      </artifact>
      <artifact>
        <path>src/components/config/GroupListItem.tsx</path>
        <kind>component</kind>
        <symbol>GroupListItem</symbol>
        <lines>existing</lines>
        <reason>Referenced in Sidebar.tsx - no changes needed, but buttons will be positioned above this list</reason>
      </artifact>
    </code>
    <dependencies>
      <ecosystem name="Node.js">
        <package name="react" version="^18.2.0" />
        <package name="react-dom" version="^18.2.0" />
        <package name="react-router-dom" version="^7.9.6" />
        <package name="lucide-react" version="^0.554.0" reason="Plus icon for buttons" />
        <package name="@radix-ui/react-slot" version="^1.2.4" reason="Button component dependency" />
        <package name="class-variance-authority" version="^0.7.1" reason="Button variants (secondary, sm)" />
        <package name="@radix-ui/react-scroll-area" version="^1.2.10" reason="Used in Sidebar for scrollable lists" />
        <package name="tailwindcss" version="^3.4.3" reason="Styling system" />
        <package name="typescript" version="^5.2.2" />
      </ecosystem>
    </dependencies>
  </artifacts>

  <constraints>
    <constraint type="architecture">Sidebar.tsx structure: Two sections (SERVERS and GROUPS) with section headers, add buttons positioned BEFORE list items, using ScrollArea for scrollable lists</constraint>
    <constraint type="design">Button styling: variant="secondary" (white bg, gray border #d4d4d4), size="sm" (32px height), full width className="w-full", Plus icon with mr-2 (8px gap), mb-3 (12px margin-bottom)</constraint>
    <constraint type="behavior">Buttons have no-op onClick handlers (empty function) - functionality implemented in Epic 2 (Story 2.7) and Epic 3 (Story 3.5)</constraint>
    <constraint type="accessibility">Buttons must be keyboard accessible - tab order, visible focus ring (blue), Enter key activation, positioned in logical flow before list items</constraint>
    <constraint type="pattern">Reuse existing keyboard navigation pattern from Sidebar (serverRefs, groupRefs, handleKeyDown) - buttons should integrate into existing tab order</constraint>
    <constraint type="testing">Manual testing required - verify visual design (secondary variant, small size), hover/focus/active states, keyboard navigation tab order, build verification (TypeScript compilation)</constraint>
  </constraints>

  <interfaces>
    <interface>
      <name>Button</name>
      <kind>React Component</kind>
      <signature>
        &lt;Button
          variant="secondary | default | destructive | outline | ghost | link"
          size="sm | default | lg | icon"
          className="string"
          onClick={() => void}
          {...buttonHTMLAttributes}
        &gt;
          children
        &lt;/Button&gt;
      </signature>
      <path>src/components/ui/button.tsx</path>
    </interface>
    <interface>
      <name>Plus Icon</name>
      <kind>React Component (lucide-react)</kind>
      <signature>
        import { Plus } from 'lucide-react'
        &lt;Plus className="h-4 w-4 mr-2" /&gt;
      </signature>
      <path>lucide-react package</path>
    </interface>
    <interface>
      <name>SidebarProps</name>
      <kind>TypeScript Interface</kind>
      <signature>
        interface SidebarProps {
          servers: ServerData[];
          groups: GroupConfig[];
          isLoading: boolean;
          error?: string | null;
          selectedServerId: string | null;
          selectedGroupId: string | null;
          onSelectServer: (id: string) => void;
          onSelectGroup: (id: string) => void;
        }
      </signature>
      <path>src/components/config/Sidebar.tsx:8-17</path>
    </interface>
  </interfaces>

  <tests>
    <standards>
      Manual testing strategy for Epic 1 (UI Foundation). No automated tests required for MVP. Build verification via TypeScript compilation (npm run build). Visual design verification through browser testing in Firefox (primary) and Chrome (secondary). Keyboard navigation testing to verify accessibility (WCAG AA compliance).
    </standards>
    <locations>
      Manual testing performed in browser. TypeScript type checking during build. Story includes comprehensive testing checklist in Dev Notes section covering visual design, interactive states, keyboard navigation, spacing/layout, click behavior, and build verification.
    </locations>
    <ideas>
      <idea ac="1">Verify "+ Add Server" button appears at top of SERVERS section with correct position (after header, before list)</idea>
      <idea ac="2">Verify "+ Add Group" button appears at top of GROUPS section with correct position (after header, before list)</idea>
      <idea ac="3">Verify button styling: secondary variant (white bg, gray border), size="sm" (compact), Plus icon (16px, h-4 w-4), full width within sidebar padding</idea>
      <idea ac="3">Test hover state: light gray background (#f5f5f5)</idea>
      <idea ac="3">Test focus state: blue ring (2px, #2563eb) visible</idea>
      <idea ac="3">Test active/pressed state: darker gray background</idea>
      <idea ac="3">Verify spacing: mb-3 (12px margin-bottom), mr-2 (8px icon gap)</idea>
      <idea ac="4">Click buttons verify no error in console, no form appears, no navigation occurs</idea>
      <idea ac="5">Tab key navigation: verify focus order (+ Add Server → servers → + Add Group → groups)</idea>
      <idea ac="5">Enter key on focused button triggers onClick (currently no-op)</idea>
      <idea ac="5">Verify blue focus ring visible during keyboard navigation</idea>
      <idea ac="all">Build verification: npm run build → no TypeScript errors, no ESLint warnings</idea>
    </ideas>
  </tests>
</story-context>
